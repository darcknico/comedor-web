{% extends 'templates/app.twig' %}

{% block content %}
<!-- BEGIN GLOBAL MANDATORY STYLES -->
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />
<!-- END GLOBAL MANDATORY STYLES -->
<!-- BEGIN PAGE LEVEL PLUGINS -->
<link href="{{ base_url() }}/metronic/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN THEME GLOBAL STYLES -->
<link href="{{ base_url() }}/metronic/assets/global/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
<!-- END THEME GLOBAL STYLES -->
<!-- BEGIN THEME LAYOUT STYLES -->
<link href="{{ base_url() }}/metronic/assets/layouts/layout4/css/layout.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/layouts/layout4/css/themes/default.min.css" rel="stylesheet" type="text/css" id="style_color" />
<link href="{{ base_url() }}/metronic/assets/layouts/layout4/css/custom.min.css" rel="stylesheet" type="text/css" />
<!-- END THEME LAYOUT STYLES -->
<link rel="shortcut icon" href="{{ base_url() }}/metronic/favicon.ico" />
<!-- BEGIN CONTENT -->
		<div class="page-content-wrapper">
				<!-- BEGIN CONTENT BODY -->
				<div class="page-content">
						<!-- BEGIN PAGE HEAD-->
						<div class="page-head">
								<!-- BEGIN PAGE TITLE -->
								<div class="page-title">
										<h1>Administrador
												<small>...</small>
										</h1>
								</div>
								<!-- END PAGE TITLE -->
						</div>
						<!-- END PAGE HEAD-->
						<!-- BEGIN PAGE BREADCRUMB -->
						<ul class="page-breadcrumb breadcrumb">
								<li>
										<a href="{{ path_for('home') }}">Inicio</a>
										<i class="fa fa-circle"></i>
								</li>
								<li>
										<span class="active">Gestionar Menu</span>
								</li>
						</ul>
						<!-- END PAGE BREADCRUMB -->
						{% include 'templates/partials/flash.twig' %}
						<!-- BEGIN PAGE BASE CONTENT -->
						<div class="row">
	            <div class="col-md-6">
	                <!-- Begin: life time stats -->
	                <div class="portlet light portlet-fit portlet-datatable bordered">
	                    <div class="portlet-title">
	                        <div class="caption">
	                            <i class="icon-calendar font-green"></i>
	                            <span class="caption-subject font-green sbold uppercase">Listado de Menus</span>
	                        </div>
	                        <div class="actions">
	                            <div class="btn-group">
																	<a id="sample_editable_1_2_new" href="{{ path_for('comedor.menu') }}" class="btn sbold green"> Nuevo
	                                    <i class="fa fa-plus"></i>
	                                </a>
	                                <a class="btn green  btn-outline dropdown-toggle" href="javascript:;" data-toggle="dropdown">
	                                    <i class="fa fa-share"></i>
	                                    <span class="hidden-xs"> Herramientas </span>
	                                    <i class="fa fa-angle-down"></i>
	                                </a>
	                                <ul class="dropdown-menu pull-right" id="sample_3_tools">
	                                    <li>
	                                        <a href="javascript:;" data-action="0" class="tool-action">
	                                            <i class="icon-printer"></i> Imprimir</a>
	                                    </li>
	                                    <li>
	                                        <a href="javascript:;" data-action="1" class="tool-action">
	                                            <i class="icon-check"></i> Copiar Datos</a>
	                                    </li>
	                                    <li>
	                                        <a href="javascript:;" data-action="2" class="tool-action">
	                                            <i class="icon-doc"></i> PDF</a>
	                                    </li>
	                                    <li>
	                                        <a href="javascript:;" data-action="3" class="tool-action">
	                                            <i class="icon-paper-clip"></i> Excel</a>
	                                    </li>
	                                    <li>
	                                        <a href="javascript:;" data-action="4" class="tool-action">
	                                            <i class="icon-cloud-upload"></i> CSV</a>
	                                    </li>
	                                    <li class="divider"> </li>
	                                    <li>
	                                        <a href="javascript:;" data-action="5" class="tool-action">
	                                            <i class="icon-refresh"></i> Recargar</a>
	                                    </li>
	                                    </li>
	                                </ul>
	                            </div>
	                        </div>
	                    </div>
	                    <div class="portlet-body">
	                        <div class="table-container">
	                            <table id="miTabla" class="table table-striped table-bordered table-hover" >
	                                <thead>
	                                    <tr>
																				<th>Fecha</th>
																				<th>Cantidad</th>
																				<th>Comprados</th>
																				<th>Precio</th>
																				<th>Estado</th>
																				<th>Opciones</th>
	                                    </tr>
	                                </thead>
	                                <tbody>
																		{% for row in data %}
	                                    <tr>
																				<td>{{row.fecha|date('d-m-Y')}}</td>
																				<td>{{row.cantidad}}</td>
																				<td>{{row.comprados}}</td>
																				<td>${{row.precio}}</td>
																				<td>
																					{% if row.finalizado %}
																						<span class="label label-sm label-danger"> Finalizado </span>
																					{% else %}
																						<span class="label label-sm label-info"> Sin Finalizar </span>
																					{% endif %}
																				</td>
																				<td>
																					<a href="{{ path_for('comedor.menu.edit',{'id':row.id} ) }}" class='btn btn-3' role='button'><span class='glyphicon glyphicon-pencil'></span></a>
																					<a href="{{ path_for('comedor.menu.delete',{'id':row.id} ) }}" class='btn btn-3' role='button'><span class='glyphicon glyphicon-remove'></span></a>
																					<a href="{{ path_for('comedor.menu.ticket.new',{'idMenu':row.id} ) }}" class='btn btn-3' role='button'><span class='glyphicon glyphicon-usd'></span></a>
																				</td>
	                                    </tr>
																		{% endfor %}
	                                </tbody>
	                            </table>
	                        </div>
	                    </div>
	                </div>
		                <!-- End: life time stats -->
		            </div>
								<div class="col-md-6 ">
                    <!-- BEGIN SAMPLE FORM PORTLET-->
                    <div class="portlet light bordered">
                        <div class="portlet-title">
														{% if old.id %}
														<div class="caption font-green">
                                <i class="icon-pin font-green"></i>
                                <span class="caption-subject bold uppercase"> Modificar Menu</span>
                            </div>
                            <div class="actions">
                                <div class="btn-group">
                                    <a class="btn btn-sm default dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Opciones
                                        <i class="fa fa-angle-down"></i>
                                    </a>
                                    <ul class="dropdown-menu pull-right">
                                        <li>
                                            <a href="{{ path_for('comedor.menu.delete',{'id':old.id} ) }}">
                                                <i class="fa fa-trash-o"></i> Borrar </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
														{% else %}
														<div class="caption font-green">
                                <i class="icon-pin font-green"></i>
                                <span class="caption-subject bold uppercase"> Agregar Menu</span>
                            </div>
														{% endif %}
                        </div>
                        <div class="portlet-body form">
													{% if old.id %}
                        		<form role="form" action="{{ path_for('comedor.menu.edit',{'id':old.id}) }}" method="post" autocomplete="off">
													{% else %}
														<form role="form" action="{{ path_for('comedor.menu.new') }}" method="post" autocomplete="off">
													{% endif %}
														<input type="hidden" id="id" name="id" value="{{old.id ? old.id:0}}">
														<div class="form-body">
															<div class="form-group {{ errors.fecha ? ' has-error' : ''}}">
                                <div class="input-group date date-picker" data-date-format="dd-mm-yyyy" data-date-start-date="+0d" data-date-language="es">
                                    <span class="input-group-btn">
                                        <button class="btn default" type="button">
                                            <i class="fa fa-calendar"></i>
                                        </button>
                                    </span>
																		<input type="text" name="fecha" id="fecha" class="form-control" value="{{ old.fecha }}" readonly required>
                                </div>
                                <!-- /input-group -->
																{% if errors.fecha %}
																	<span class="help-block">{{ errors.fecha | first }}</span>
																{% else %}
                                <span class="help-block"> Seleccione la fecha </span>
																{% endif %}
                            	</div>
                              <div class="form-group form-md-line-input form-md-floating-label{{ errors.cantidad ? ' has-error' : ''}}">
	                              <input type="number" min="0" max="1000" step="1" name="cantidad" id="cantidad" class="form-control" value="{{ old.cantidad }}" required>
	                              <label for="form_control_1">Cantidad de Tickets</label>
																{% if errors.cantidad %}
																	<span class="help-block">{{ errors.cantidad | first }}</span>
																{% else %}
	                              	<span class="help-block">Tickets disponibles para la venta</span>
																{% endif %}
                              </div>
															<div class="form-group form-md-line-input form-md-floating-label{{ errors.precio ? ' has-error' : ''}}">
																<input type="text" name="precio" id="precio" class="form-control" value="{{ old.precio }}" required>
																<label for="form_control_1">Precio</label>
																{% if errors.precio %}
																	<span class="help-block">{{ errors.precio | first }}</span>
																{% else %}
																	<span class="help-block">Precio de un Ticket para la venta</span>
																{% endif %}
															</div>
															<div class="form-group form-md-line-input form-md-floating-label{{ errors.descripcion ? ' has-error' : ''}}">
																<input type="text" name="descripcion" id="descripcion" class="form-control" value="{{ old.descripcion }}" required>
																<label for="form_control_1">Descripcion</label>
																{% if errors.descripcion %}
																	<span class="help-block">{{ errors.descripcion | first }}</span>
																{% else %}
																	<span class="help-block">Menu o platos</span>
																{% endif %}
															</div>
                            </div>
                            <div class="form-actions noborder">
                                <button type="submit" class="btn blue pull-right">Guardar</button>
                            </div>
														{{ csrf.field | raw }}
                          </form>
                        </div>
                    </div>
                    <!-- END SAMPLE FORM PORTLET-->
								</div>
						<!-- END PAGE BASE CONTENT -->
				</div>
				<!-- END CONTENT BODY -->
		</div>
		<!-- END CONTENT -->
		<!-- BEGIN CORE PLUGINS -->
    <script src="{{ base_url() }}/metronic/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/global/plugins/js.cookie.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
    <!-- END CORE PLUGINS -->
		<!-- BEGIN PAGE LEVEL PLUGINS -->
    <script src="{{ base_url() }}/metronic/assets/global/scripts/datatable.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script>
		<script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
		<script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-datepicker/locales/bootstrap-datepicker.es.min.js" charset="UTF-8" type="text/javascript"></script>
    <!-- END PAGE LEVEL PLUGINS -->
    <!-- BEGIN THEME GLOBAL SCRIPTS -->
    <script src="{{ base_url() }}/metronic/assets/global/scripts/app.min.js" type="text/javascript"></script>
    <!-- END THEME GLOBAL SCRIPTS -->
    <!-- BEGIN PAGE LEVEL SCRIPTS -->
		<script src="{{ base_url() }}/metronic/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js" type="text/javascript"></script>
		<script src="{{ base_url() }}/metronic/assets/global/plugins/jquery.input-ip-address-control-1.0.min.js" type="text/javascript"></script>
		<script src="{{ base_url() }}/metronic/assets/global/plugins/moment.min.js" type="text/javascript"></script>
		<script>

		jQuery(document).ready(function() {

			var table = $('#miTabla');

			var oTable = table.dataTable({

					// Internationalisation. For more info refer to http://datatables.net/manual/i18n
					"language": {
							"aria": {
									"sortAscending": ": activate to sort column ascending",
									"sortDescending": ": activate to sort column descending"
							},
							"emptyTable": "No hay registros",
							"info": "Mostrando del _START_ al _END_ de _TOTAL_ entradas",
							"infoEmpty": "Entradas no encontradas",
							"infoFiltered": "(filtered1 from _MAX_ total entradas)",
							"lengthMenu": "_MENU_ entradas",
							"search": "Buscar:",
							"zeroRecords": "No hay coincidencias"
					},

					// Or you can use remote translation file
					//"language": {
					//   url: '//cdn.datatables.net/plug-ins/3cfcc339e89/i18n/Portuguese.json'
					//},

					buttons: [
							{ extend: 'print', className: 'btn dark btn-outline' },
							{ extend: 'copy', className: 'btn red btn-outline' },
							{ extend: 'pdf', className: 'btn green btn-outline' },
							{ extend: 'excel', className: 'btn yellow btn-outline ' },
							{ extend: 'csv', className: 'btn purple btn-outline ' },
							{ extend: 'colvis', className: 'btn dark btn-outline', text: 'Columns'}
					],

					// setup responsive extension: http://datatables.net/extensions/responsive/
					responsive: true,

					//"ordering": false, disable column ordering
					//"paging": false, disable pagination

					"order": [
							[0, 'asc']
					],

					"lengthMenu": [
							[5, 10, 15, 20, -1],
							[5, 10, 15, 20, "All"] // change per page values here
					],
					// set the initial value
					"pageLength": 5,

					//"dom": "<'row' <'col-md-12'>><'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'f>r><'table-scrollable't><'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>", // horizobtal scrollable datatable

					// Uncomment below line("dom" parameter) to fix the dropdown overflow issue in the datatable cells. The default datatable layout
					// setup uses scrollable div(table-scrollable) with overflow:auto to enable vertical scroll(see: assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js).
					// So when dropdowns used the scrollable div should be removed.
					//"dom": "<'row' <'col-md-12'T>><'row'<'col-md-6 col-sm-12'l><'col-md-6 col-sm-12'f>r>t<'row'<'col-md-5 col-sm-12'i><'col-md-7 col-sm-12'p>>",
			});

			// handle datatable custom tools
			$('#sample_3_tools > li > a.tool-action').on('click', function() {
					var action = $(this).attr('data-action');
					oTable.DataTable().button(action).trigger();
			});

			$("#precio").inputmask("numeric", {
        numericInput: true,
        placeholder: '0',
        groupSeparator: ',',
        autoGroup: true
      });
		});
		</script>
    <!-- END PAGE LEVEL SCRIPTS -->
		<!-- BEGIN THEME GLOBAL SCRIPTS -->
    <script src="{{ base_url() }}/metronic/assets/global/scripts/app.min.js" type="text/javascript"></script>
    <!-- END THEME GLOBAL SCRIPTS -->
    <!-- BEGIN PAGE LEVEL SCRIPTS -->
		<script src="{{ base_url() }}/metronic/assets/pages/scripts/form-input-mask.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/pages/scripts/components-date-time-pickers.min.js" type="text/javascript"></script>
    <!-- END PAGE LEVEL SCRIPTS -->
    <!-- BEGIN THEME LAYOUT SCRIPTS -->
    <script src="{{ base_url() }}/metronic/assets/layouts/layout4/scripts/layout.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/layouts/layout4/scripts/demo.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/layouts/global/scripts/quick-sidebar.min.js" type="text/javascript"></script>
    <script src="{{ base_url() }}/metronic/assets/layouts/global/scripts/quick-nav.min.js" type="text/javascript"></script>
    <!-- END THEME LAYOUT SCRIPTS -->

{% endblock %}
