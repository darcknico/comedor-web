{% extends 'templates/app.twig' %}

{% block content %}
<!-- BEGIN GLOBAL MANDATORY STYLES -->
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />
<!-- END GLOBAL MANDATORY STYLES -->
<!-- BEGIN PAGE LEVEL PLUGINS -->
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-toastr/toastr.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN THEME GLOBAL STYLES -->
<link href="{{ base_url() }}/metronic/assets/global/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
<!-- END THEME GLOBAL STYLES -->
<!-- BEGIN PAGE LEVEL STYLES -->
<link href="{{ base_url() }}/metronic/assets/pages/css/profile.min.css" rel="stylesheet" type="text/css" />
<!-- END PAGE LEVEL STYLES -->
<!-- BEGIN THEME LAYOUT STYLES -->
<link href="{{ base_url() }}/metronic/assets/layouts/layout4/css/layout.min.css" rel="stylesheet" type="text/css" />
<link href="{{ base_url() }}/metronic/assets/layouts/layout4/css/themes/default.min.css" rel="stylesheet" type="text/css" id="style_color" />
<link href="{{ base_url() }}/metronic/assets/layouts/layout4/css/custom.min.css" rel="stylesheet" type="text/css" />
<!-- END THEME LAYOUT STYLES -->
<link rel="shortcut icon" href="{{ base_url() }}/metronic/favicon.ico" />
<!-- BEGIN CONTENT -->
<div class="page-content-wrapper">
		<!-- BEGIN CONTENT BODY -->
		<div class="page-content">
				<!-- BEGIN PAGE HEAD-->
				<div class="page-head">
						<!-- BEGIN PAGE TITLE -->
						<div class="page-title">
								<h1>Administrador
										<small>...</small>
								</h1>
						</div>
						<!-- END PAGE TITLE -->
				</div>
				<!-- END PAGE HEAD-->
				<!-- BEGIN PAGE BREADCRUMB -->
				<ul class="page-breadcrumb breadcrumb">
						<li>
								<a href="{{ path_for('home') }}">Inicio</a>
								<i class="fa fa-circle"></i>
						</li>
						<li>
								<span class="active">Menu del dia {{menu.fecha}}</span>
						</li>
				</ul>
				<!-- END PAGE BREADCRUMB -->
				{% include 'templates/partials/flash.twig' %}
				<!-- BEGIN PAGE BASE CONTENT -->
				<div class="row">
						<div class="col-md-6 ">
                <!-- BEGIN SAMPLE FORM PORTLET-->
                <div class="portlet light bordered">
										<div class="portlet-title">
												<div class="caption font-green">
														<i class="icon-pin font-green"></i>
														<span class="caption-subject bold uppercase"> Descripcion del  Menu</span>
												</div>
												<div class="actions">
                            <div class="btn-group">
                                <a class="btn btn-sm default dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Opciones
                                    <i class="fa fa-angle-down"></i>
                                </a>
                                <ul class="dropdown-menu pull-right">
                                    <li>
                                        <a href="{{ path_for('comedor.menu.delete',{'id':old.id} ) }}">
                                            <i class="fa fa-trash-o"></i> Finalizar </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
										</div>

                    <div class="portlet-body form">
												<input type="hidden" id="id" name="id" value="{{menu.id ? menu.id:0}}">
												<div class="form-body">
													<div class="form-group">
                            <div class="input-group date date-picker" data-date-format="dd-mm-yyyy" data-date-start-date="+0d" data-date-language="es">
                                <span class="input-group-btn">
                                    <button class="btn default" type="button">
                                        <i class="fa fa-calendar"></i>
                                    </button>
                                </span>
																<input type="text" name="fecha" id="fechaMenu" class="form-control" value="{{ menu.fecha }}" readonly>
                            </div>
                        	</div>
                          <div class="form-group form-md-line-input form-md-floating-label">
                            <input type="number" min="0" max="1000" step="1" name="cantidad" id="cantidad" class="form-control" value="{{ menu.cantidad }}" readonly>
                            <label for="form_control_1">Cantidad de Tickets</label>
                          </div>
													<div class="form-group form-md-line-input form-md-floating-label">
														<div class="input-group left-addon">
                                <span class="input-group-addon">$</span>
																<input type="text" name="precio" id="precio" class="form-control" value="{{ menu.precio }}" readonly>
																<label for="form_control_1">Precio</label>
                            </div>
													</div>
													<div class="form-group form-md-line-input form-md-floating-label">
														<input type="text" name="descripcion" id="descripcion" class="form-control" value="{{ menu.descripcion }}" readonly>
														<label for="form_control_1">Descripcion</label>
													</div>
													<div class="form-group form-md-line-input form-md-floating-label">
														<input type="text" name="descripcion" id="descripcion" class="form-control" value="{{ menu.validados }}" readonly>
														<label for="form_control_1">Validados actualmente</label>
													</div>
                        </div>
                    </div>
                </div>
                <!-- END SAMPLE FORM PORTLET-->
						</div>
						<div class="col-md-6 ">
                <!-- BEGIN SAMPLE FORM PORTLET-->
                <div class="portlet light bordered">
										<div class="portlet-title">
												<div class="caption font-green">
														<i class="icon-pin font-green"></i>
														<span class="caption-subject bold uppercase">Ingreso del Codigo</span>
												</div>
										</div>
                    <div class="portlet-body form">
												<div class="form-group form-md-line-input form-md-floating-label">
                            <div class="input-group">
                                <div class="input-group-control">
                                    <input type="number" class="form-control input-sm" id="ticketCodigo" autofocus>
                                    <label for="form_control_1">Codigo del Ticket</label>
                                </div>
                                <span class="input-group-btn btn-right">
                                    <a id="btnValidar" class="btn green-haze" type="button" onclick="validarCodigo()">Buscar</a>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END SAMPLE FORM PORTLET-->
						</div>
						<div id="usuario" class="col-md-3" hidden>
                <!-- BEGIN SAMPLE FORM PORTLET-->
								<!-- BEGIN PROFILE SIDEBAR -->
                        <div class="profile-sidebar">
                            <!-- PORTLET MAIN -->
                            <div class="portlet light profile-sidebar-portlet bordered">
                                <!-- SIDEBAR USERPIC -->
                                <div class="profile-userpic">
                                    <img src="{{ base_url() }}/metronic/assets/pages/media/profile/profile_user.jpg" class="img-responsive" alt=""> </div>
                                <!-- END SIDEBAR USERPIC -->
                                <!-- SIDEBAR USER TITLE -->
                                <div class="profile-usertitle">
                                    <div class="profile-usertitle-name" id='nombreUsuario'> Marcus Doe </div>
                                    <div class="profile-usertitle-job" id='tipoUsuario'> Estudiante </div>
                                </div>
                                <!-- END SIDEBAR USER TITLE -->
                                <!-- SIDEBAR BUTTONS -->
                                <div class="profile-userbuttons">
                                    <button type="button" class="btn btn-circle green btn-sm">Validar</button>
                                </div>
                                <!-- END SIDEBAR BUTTONS -->
                                <!-- SIDEBAR MENU -->
                                <div class="profile-usermenu">
                                </div>
                                <!-- END MENU -->
                            </div>
                            <!-- END PORTLET MAIN -->
                        </div>
                        <!-- END BEGIN PROFILE SIDEBAR -->
                <!-- END SAMPLE FORM PORTLET-->
						</div>
				<!-- END PAGE BASE CONTENT -->
		</div>
		<!-- END CONTENT BODY -->
</div>
<!-- END CONTENT -->
<!-- BEGIN CORE PLUGINS -->
<script src="{{ base_url() }}/metronic/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/js.cookie.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script>
<!-- END CORE PLUGINS -->
<!-- BEGIN PAGE LEVEL PLUGINS -->
<script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-toastr/toastr.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/bootstrap-datepicker/locales/bootstrap-datepicker.es.min.js" charset="UTF-8" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/jquery.sparkline.min.js" type="text/javascript"></script>
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN THEME GLOBAL SCRIPTS -->
<script src="{{ base_url() }}/metronic/assets/global/scripts/app.min.js" type="text/javascript"></script>
<!-- END THEME GLOBAL SCRIPTS -->
<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script src="{{ base_url() }}/metronic/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/jquery.input-ip-address-control-1.0.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/global/plugins/moment.min.js" type="text/javascript"></script>
<script>

jQuery(document).ready(function() {

	$("#precio").inputmask("numeric", {
    numericInput: true,
    placeholder: '0',
    groupSeparator: ',',
    autoGroup: true
  });

	$("#ticketCodigo").on('keyup', function (e) {
	    if (e.keyCode == 13) {
	        validarCodigo();
	    }
	});
	function validarCodigo(){
		var codigo =
		$('#ticketCodigo').val();
		var noEncontrado = true;
		if(codigo){
			if(codigo.length == 18 ){
				$.ajax({
			    url: '{{ path_for('comedor.ticket.codigo') }}'+'?codigo='+codigo,
			    type: 'GET',
			    dataType: 'json',
			    success: function(data){
						if($('#fechaMenu').val()==data.fecha){
							$('#nombreUsuario').text(data.usuario.apellido+' '+data.usuario.nombre);
							toastr.success("El codigo del ticket es valido", "Ticket correto");
							$('#usuario').show();
							noEncontrado = false;
							$('#ticketCodigo').val(' ');
							window.location.hash = 'usuario';
						} else {
							toastr.error("El codigo del ticket corresponde a otra fecha", "Ticket incorrecto");
						}
			    },
					error: function(){
						toastr.error("El codigo ingresado no esta correto", "Codigo no valido");
					}
			  });
			} else {
				toastr.warning("El codigo ingresado no corresponde a un formato valido", "Codigo no valido");
			}
		} else {
			toastr.warning("Debe ingresar un codigo", "Codigo vacio");
		}
		if(noEncontrado){
			$('#usuario').hide();
		}
		return false;
	};

	toastr.options = {
	  "closeButton": true,
	  "debug": false,
	  "positionClass": "toast-bottom-full-width",
	  "onclick": null,
	  "showDuration": "1500",
	  "hideDuration": "1500",
	  "timeOut": "7500",
	  "extendedTimeOut": "1000",
	  "showEasing": "swing",
	  "hideEasing": "linear",
	  "showMethod": "fadeIn",
	  "hideMethod": "fadeOut"
	}
});

</script>

<!-- END PAGE LEVEL SCRIPTS -->
<!-- BEGIN THEME GLOBAL SCRIPTS -->
<script src="{{ base_url() }}/metronic/assets/global/scripts/app.min.js" type="text/javascript"></script>
<!-- END THEME GLOBAL SCRIPTS -->
<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script src="{{ base_url() }}/metronic/assets/pages/scripts/ui-toastr.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/pages/scripts/profile.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/pages/scripts/form-input-mask.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/pages/scripts/components-date-time-pickers.min.js" type="text/javascript"></script>
<!-- END PAGE LEVEL SCRIPTS -->
<!-- BEGIN THEME LAYOUT SCRIPTS -->
<script src="{{ base_url() }}/metronic/assets/layouts/layout4/scripts/layout.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/layouts/layout4/scripts/demo.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/layouts/global/scripts/quick-sidebar.min.js" type="text/javascript"></script>
<script src="{{ base_url() }}/metronic/assets/layouts/global/scripts/quick-nav.min.js" type="text/javascript"></script>
<!-- END THEME LAYOUT SCRIPTS -->
{% endblock %}
